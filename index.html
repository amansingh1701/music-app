<!DOCTYPE html>
<html>
  <head>
    <title>img2wav</title>
    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css"
      type="text/css"
    />
    <script
      type="text/javascript"
      src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"
    ></script>
    <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
  </head>
  <body>
    <h1></h1>
    <div
      style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      "
    >
      <img
        style="padding-top: 1rem; padding-bottom: 1rem"
        id="output_image"
        height="250px"
        width="250px"
      />
      <form action="#">
        <input type="file" onchange="preview_image(event)" />
        <button type="button" onclick="submit_form(event)">Submit Image</button>
      </form>
      <script type="text/javascript">
        let readerResult;
        function preview_image(event) {
          var reader = new FileReader();
          reader.onload = function () {
            var output = document.getElementById("output_image");
            output.src = reader.result;
            readerResult = reader.result;
          };
          reader.readAsDataURL(event.target.files[0]);
        }

        function submit_form(event) {
          event.preventDefault();
          fetch("https://music-from-picture--backend.herokuapp.com/upload-image", {
            method: "POST",
            mode: "cors",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ file: readerResult }),
          })
            .then((res) => res.json())
            .then((res) => {
              console.log(`Response from Notes`, res);
            }).then((res)=>{
              window.location.replace("play.html");
            });
        }
      </script>
    </div>
    <script>
      window.onload = function () {
        fetch("https://music-from-picture--backend.herokuapp.com/delete-image", {
            method: "POST",
            mode: "cors",
            headers: {
              "Content-Type": "application/json",
            },
          })
            .then((res) => res.json())
            .then((res) => {
              console.log(`Response from Notes`, res);
            });
      };
    </script>
  </body>
</html>
